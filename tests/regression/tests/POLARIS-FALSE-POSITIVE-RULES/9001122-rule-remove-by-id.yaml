---
meta:
  author: "ngoctin"
  enabled: true
  name: "polaris-false-positive"
  description: "Polaris false positive test"
tests:
- desc: false positive in rule 9001122
  stages:
  - stage:
      input:
        data: 'x=%27+or+%271%27%3D%271%27+--+---------------------'
        dest_addr: localhost
        headers:
          Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Host: localhost
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
            like Gecko) Chrome/83.0.4103.61 Safari/537.36 Edg/83.0.478.37
        method: GET
        port: 80
        uri: /admin/config/
        version: HTTP/1.1
      output:
        log_contains: '"id":"\d+"'
        no_log_contains: 'id "942430"'
  test_title: 9001122-1
- desc: false positive in rule 9001122
  stages:
  - stage:
      input:
        data: 'x=%27+or+%271%27%3D%271%27+--+---------------------'
        dest_addr: localhost
        headers:
          Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
          Accept-Encoding: gzip, deflate, br
          Accept-Language: en-US,en;q=0.9
          Host: localhost
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
            like Gecko) Chrome/83.0.4103.61 Safari/537.36 Edg/83.0.478.37
        method: GET
        port: 80
        uri: /admin
        version: HTTP/1.1
      output:
        log_contains: 'id "942430"'
  test_title: 9001122-2
